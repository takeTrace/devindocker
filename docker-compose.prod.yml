version: '3.8'

services:
  nginx:
    extends:
      file: docker-compose.base.yml
      service: nginx
    ports:
      - "8080:80"
  redis:
    extends:
      file: docker-compose.base.yml
      service: redis
  mongodb:
    container_name: mongodb
    extends:
      file: docker-compose.base.yml
      service: mongodb
    user: root
    volumes:
      - mongo-db:/data/db

  devindocker:
    extends:
      file: docker-compose.base.yml
      service: devindocker
    image: taketrace00/devindocker
    build:
      context: .
      args:
        NODE_ENV: production
    env_file: .env
    command: npm run start

volumes:
  mongo-db:
    name: 'mongo-db'
